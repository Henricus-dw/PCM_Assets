<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>PCM Dashboard</title>
    <link rel="stylesheet" href="/static/styles.css?v={{ time }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Sidebar (220px wide; CSS already handles styling) -->
    <div class="sidebar">
        <img src="/static/pcm-lockup-goldc-final.svg" alt="PCM logo" />

        <!-- Top navigation -->
        <div class="nav-top">
            <a href="/dashboard" class="{{ 'active' if section == 'home' else '' }}"><span>Home</span></a>
            <a href="/form" class="{{ 'active' if section == 'form' else '' }}"><span>Capturing Form</span></a>
            <a href="/dashboard/vodacom" class="{{ 'active' if section == 'vodacom' else '' }}"><span>Vodacom
                    Dashboard</span></a>
            <a href="/dashboard/devices" class="{{ 'active' if section == 'devices' else '' }}"><span>Devices
                    Dashboard</span></a>
        </div>

        <!-- Bottom navigation -->
        <div class="nav-bottom">
            <a href="/admin" class="{{ 'active' if section == 'admin' else '' }}"><span>Admin</span></a>
            <a href="/settings" class="{{ 'active' if section == 'settings' else '' }}"><span>Settings</span></a>
            <a href="/logout" class="{{ 'active' if section == 'logout' else '' }}"><span>Log Out</span></a>
        </div>
    </div>
    <button id="sidebarHandle" class="sidebar-handle" aria-label="Collapse sidebar" aria-pressed="false"
        title="Collapse sidebar"> <span class="handle-icon" aria-hidden="true">‚ü®</span> </button>


    <div class="content" style="margin:20px var(--content-gap) 20px var(--sidebar-space);">
        <div class="contentInner" style="max-width:820px;margin:auto;">
            <div class="boxTopHeader">Pending account requests</div>
            <div style="padding:20px;">
                {% if not pending %}
                <p class="muted">No pending requests.</p>
                {% else %}
                <table class="sticky" style="width:100%;">
                    <thead class="header-row">
                        <tr>
                            <th>Name</th>
                            <th>Surname</th>
                            <th>Email</th>
                            <th style="width:210px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for p in pending %}
                        <tr>
                            <td>{{ p.name }}</td>
                            <td>{{ p.surname }}</td>
                            <td>{{ p.email }}</td>
                            <td>
                                <form method="post" action="/admin/approve/{{ p.id }}" style="display:inline;">
                                    <button class="view-contracts-btn" type="submit">Approve</button>
                                </form>
                                <form method="post" action="/admin/deny/{{ p.id }}"
                                    style="display:inline;margin-left:6px;">
                                    <button class="view-contracts-btn" type="submit">Deny</button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% endif %}
            </div>
        </div>
    </div>


    <script>



        document.addEventListener("DOMContentLoaded", () => {
            const handle = document.getElementById("sidebarHandle");
            const collapseBtn = document.getElementById("sidebarCollapse"); // optional header button
            const scrim = document.getElementById("sidebarScrim");

            function toggleSidebar() {
                const collapsed = document.body.classList.toggle("sidebar-collapsed");

                handle?.setAttribute("aria-pressed", String(!collapsed ? true : false));
                handle?.setAttribute(
                    "aria-label",
                    collapsed ? "Expand sidebar" : "Collapse sidebar"
                );
                handle.title = collapsed ? "Expand sidebar" : "Collapse sidebar";
            }

            handle?.addEventListener("click", toggleSidebar);
            collapseBtn?.addEventListener("click", toggleSidebar);

            scrim?.addEventListener("click", () => {
                document.body.classList.remove("sidebar-open");
            });
        });

    </script>

</body>

</html>